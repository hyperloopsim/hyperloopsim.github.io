<!DOCTYPE HTML>
<html>
  <head>
    <style>
      body {
        margin: 0px;
        padding: 0px;
      }
    </style>
  </head>
  <body>
    <div id="container"></div>
    <script src="//ajax.googleapis.com/ajax/libs/threejs/r67/three.min.js"></script>
    <script src="OrbitControls.js"></script>
    <script defer="defer">
      
    var scene, camera, renderer;
    var geometry, material, mesh;


    init();
    animate();


    function createMaterial(stories) {
        var txtr = new THREE.ImageUtils.loadTexture('building.jpg');
        txtr.wrapS = txtr.wrapT = THREE.RepeatWrapping;
        txtr.repeat.set( 1, stories ); 
      
        material = new THREE.MeshBasicMaterial( { map:txtr } );
        return material;
    }
    
    function createGeometry(stories) {
        geometry = new THREE.BoxGeometry( 20, 20*stories, 20 );
        return geometry;
    }
    
    function createSky() {
        var imagePrefix = "";
        var directions  = ["xpos", "xneg", "ypos", "yneg", "zpos", "zneg"];
        var imageSuffix = ".jpg";
        var skyGeometry = new THREE.CubeGeometry( 10000, 10000, 10000 );	
        
        var materialArray = [];
        for (var i = 0; i < 6; i++)
        	materialArray.push( new THREE.MeshBasicMaterial({
        		map: THREE.ImageUtils.loadTexture( imagePrefix + directions[i] + imageSuffix ),
        		side: THREE.BackSide
        	}));
        var skyMaterial = new THREE.MeshFaceMaterial( materialArray );
        var skyBox = new THREE.Mesh( skyGeometry, skyMaterial );
        return skyBox;
      
    }
    
    function init() {


        scene = new THREE.Scene();


        camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 1, 15000 );
        camera.position.z = 50;


        groundGeom = new THREE.PlaneGeometry(10000,10000);
        
        var groundTxtr = new THREE.ImageUtils.loadTexture('ground.jpg');
        groundTxtr.wrapS = groundTxtr.wrapT = THREE.RepeatWrapping;
        groundTxtr.repeat.set( 100, 100 );
        
        groundMat = new THREE.MeshBasicMaterial( { map:groundTxtr } );
        
        ground = new THREE.Mesh(groundGeom, groundMat);
        scene.add(ground);

        for(var i = 0; i < 4; i++) {
            var stories = Math.floor((Math.random() * 5) + 2);
            mesh = new THREE.Mesh( createGeometry(stories), createMaterial(stories) );
            scene.add( mesh );
            mesh.position.z = -60*i;
            mesh.position.y = stories*10;
        }
        
        ground.rotation.x = -90 * Math.PI / 180;
        
        skyBox = createSky();
        scene.add( skyBox );
        

        renderer = new THREE.WebGLRenderer();
        renderer.setSize( window.innerWidth, window.innerHeight );


        document.body.appendChild( renderer.domElement );
        
        controls = new THREE.OrbitControls(camera, renderer.domElement);


    }


    function animate() {


        requestAnimationFrame( animate );


        //mesh.rotation.x += 0.01;
        //mesh.rotation.y += 0.02;


        renderer.render( scene, camera );

        controls.update();
    }




    </script>
  </body>
</html>      
